{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Signup Page</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
    <!-- Favicons -->
    <link rel="icon" type="image/svg+xml" href="{% static 'assets/img/logos/gs-favicon.svg' %}" />
    <link rel="alternate icon" href="{% static 'assets/img/logos/gs-favicon.ico' %}" />
    <link rel="mask-icon" href="{% static 'assets/img/logos/gs-favicon.ico' %}" />
    <link rel="apple-touch-icon" sizes="180x180" href="{% static 'assets/img/logos/gs-favicon-180.png' %}" />
    <style>
      body {
        background-color: #0b1727;
        background-size: cover;
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        margin: 0;
        font-family: Arial, sans-serif;
        position: relative;
      }
      .login-card {
        background: rgba(255, 255, 255, 0.9);
        padding: 1.5rem;
        border-radius: 10px;
        width: 100%;
        max-width: 400px;
        text-align: center;
        margin: 20px;
      }
      .login-card h2 {
        color: #003087;
        font-size: 1.3rem;
        margin-bottom: 0.8rem;
      }
      .form-select,
      .form-control {
        border-radius: 0;
        border: 1px solid #ced4da;
      }
      .btn-primary {
        background-color: #003087;
        border-color: #003087;
        border-radius: 0;
        width: 100%;
      }
      .btn-primary:hover {
        background-color: #002766;
        border-color: #002766;
      }
      .form-check-label {
        color: #003087;
      }
      .text-muted a {
        color: #003087;
        text-decoration: none;
      }
      .text-muted a:hover {
        text-decoration: underline;
      }
      #loader {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.5);
        justify-content: center;
        align-items: center;
        z-index: 1000;
      }
    </style>
  </head>
  <body>
    <div class="login-card">
      <h3 class="mb-2">Create a Goldman.com Account</h3>
      <form id="signupForm" method="post" action="{% url 'signup' %}">
        {% csrf_token %}
        <div class="mb-3">
          <input type="email" class="form-control" name="email" placeholder="Email" required />
        </div>
        <div class="mb-3">
          <input type="text" class="form-control" name="fullname" placeholder="Full Name" required />
        </div>
        <div class="mb-3">
          <input type="tel" class="form-control" name="phone" placeholder="Phone" required />
        </div>
        <div class="mb-3">
          <input type="text" class="form-control" name="address" placeholder="Address" required />
        </div>
        <div class="mb-3">
          <select class="form-select" name="gender" aria-label="Gender">
            <option value="P" selected>Prefer not to say</option>
            <option value="M">Male</option>
            <option value="F">Female</option>
            <option value="O">Other</option>
          </select>
        </div>

        <div class="mb-3">
          <input type="password" class="form-control" name="password" placeholder="Password" required />
        </div>
        <button type="submit" class="btn btn-primary mb-3">Sign Up</button>
      </form>
    </div>
    <!-- Loader Spinner -->
    <div id="loader">
      <div class="spinner-border text-light" role="status">
        <span class="visually-hidden">Loading...</span>
      </div>
    </div>
    <!-- SweetAlert2 and Bootstrap JS -->
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script>
      document.getElementById('signupForm').addEventListener('submit', function (e) {
        e.preventDefault()
      
        // Show loader
        const loader = document.getElementById('loader')
        loader.style.display = 'flex'
      
        fetch(this.action, {
          method: 'POST',
          body: new FormData(this),
          headers: {
            'X-CSRFToken': '{{ csrf_token }}'
          }
        })
          .then((response) => response.json())
          .then((data) => {
            // Hide loader
            loader.style.display = 'none'
      
            if (data.status === 'success') {
              Swal.fire({
                title: 'Success!',
                text: data.message,
                icon: 'success',
                confirmButtonText: 'OK'
              }).then((result) => {
                if (result.isConfirmed) {
                  window.location.href = '/client_login/' // Redirect to client login page
                }
              })
            } else {
              Swal.fire({
                title: 'Error!',
                text: data.message,
                icon: 'error',
                confirmButtonText: 'OK'
              })
            }
          })
          .catch((error) => {
            // Hide loader on error
            loader.style.display = 'none'
            Swal.fire({
              title: 'Error!',
              text: 'An unexpected error occurred. Please try again.',
              icon: 'error',
              confirmButtonText: 'OK'
            })
          })
      })
    </script>
  </body>
</html>
